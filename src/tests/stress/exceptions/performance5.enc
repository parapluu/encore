-- For measuring raw running time overhead of exception handling.
active class A
  def foo() : int
    1
  end
  def throw_() : int
    throw RuntimeException
    1
  end
end

active class Main

  def main(args : [String]) : unit
    var n = 200000
    var nactors = 8
    if |args| > 1 then
      match args(1).to_int() with
        case Just(x) =>
          n = x
        end
      end
    end
    if |args| > 2 then
      match args(2).to_int() with
        case Just(x) =>
          nactors = x
        end
      end
    end
    -- Creating actors
    var a = new [A](nactors)
    repeat i <- nactors do
      a(i) = new A()
    end

    -- The test: try-catch + get
    repeat i <- n do
      try
        get(a(i % nactors) ! foo())
      catch
        -1
      end
    end
    println("Done")
  end

end
